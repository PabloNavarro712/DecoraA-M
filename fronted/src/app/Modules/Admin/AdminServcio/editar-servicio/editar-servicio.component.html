

<div class="container">
  <!-- Si hay un servicio seleccionado, se muestra el formulario de edición sin necesidad de un botón flotante -->
  <div *ngIf="servicioSeleccionado; else noServicioSeleccionado">
    <div class="card mb-3">
      <div class="card-header d-flex justify-content-between">
        <span>Servicio: {{ servicioSeleccionado.titulo }}</span>
        <button class="btn btn-danger btn-sm" (click)="eliminarServicio(servicioSeleccionado.id ? servicioSeleccionado.id.toString() : '')">Eliminar</button>
        <button class="btn btn-primary btn-sm" (click)="seleccionarServicio(servicioSeleccionado)">Editar</button>
      </div>
      <div class="card-body">
        <form [formGroup]="servicioForm" (ngSubmit)="guardarServicio()">
          <div class="form-group">
            <label>Título</label>
            <input formControlName="titulo" class="form-control" placeholder="Título" />
          </div>

          <div class="form-group">
            <label>Descripción</label>
            <textarea formControlName="descripcion" class="form-control" rows="3"></textarea>
          </div>

          <div class="form-group">
            <label>Precio</label>
            <input formControlName="precio" type="number" class="form-control" placeholder="Precio" />
          </div>

          <div class="form-group">
            <label>Imagen</label>
            <input type="file" (change)="onImageSelected($event)" />
            <img *ngIf="imagenPreview" [src]="imagenPreview" class="img-thumbnail mt-2" alt="Vista previa de la imagen">
          </div>

          <!-- Elementos -->
          <div formArrayName="elementos">
            <div *ngFor="let elemento of elementos.controls; let i = index">
              <label>Elemento {{ i + 1 }}</label>
              <input [formControlName]="i" class="form-control" />
              <button (click)="eliminarElemento(i)" class="btn btn-sm btn-danger">Eliminar Elemento</button>
            </div>
            <button (click)="agregarElemento()" class="btn btn-sm btn-secondary">Agregar Elemento</button>
          </div>

          <!-- Opciones -->
          <div formArrayName="opciones">
            <div *ngFor="let opcion of opciones.controls; let j = index" [formGroupName]="j">
              <label>Opción {{ j + 1 }}</label>
              <input formControlName="nombre" placeholder="Nombre de la opción" class="form-control" />
              <input formControlName="precio" type="number" placeholder="Precio de la opción" class="form-control" />
              <button (click)="eliminarOpcion(j)" class="btn btn-sm btn-danger">Eliminar Opción</button>
            </div>
            <button (click)="agregarOpcion()" class="btn btn-sm btn-secondary">Agregar Opción</button>
          </div>

          <!-- Botones de guardar y cancelar -->
          <button type="submit" class="btn btn-success mt-3" (click)="confirmarGuardado()">Guardar cambios</button>
        </form>
      </div>
    </div>
  </div>

  <!-- En caso de que no haya servicio seleccionado, muestra el mensaje o el modal para agregar un nuevo servicio -->
  <ng-template #noServicioSeleccionado>
    <button class="btn btn-primary floating-btn" (click)="toggleCrearForm()">+</button>
  </ng-template>
</div>

<!-- Modal para crear un nuevo servicio -->
<div class="modal fade" id="crearServicioModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Crear Nuevo Servicio</h5>
        <button type="button" class="close" (click)="toggleCrearForm()">&times;</button>
      </div>
      <div class="modal-body">
        <!-- Formulario de creación de servicio reutilizando servicioForm -->
        <!-- Similar a la tarjeta de edición pero para un nuevo servicio -->
      </div>
    </div>
  </div>
</div>
 