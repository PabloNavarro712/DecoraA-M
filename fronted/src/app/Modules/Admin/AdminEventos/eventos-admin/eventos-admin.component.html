<div class="container">
  <h1>Reservas</h1>
  <!-- Filtros -->
  <div class="filters">
    <label for="fecha">Fecha:</label>
    <input type="date" id="fecha" [(ngModel)]="filtros.fecha" (input)="aplicarFiltros()" />

    <label for="tipoEvento">Tipo de Evento:</label>
    <select id="tipoEvento" [(ngModel)]="filtros.tipoEvento" (change)="aplicarFiltros()">
      <option value="">Todos</option>
      <option value="Boda">Boda</option>
      <option value="XV Años">XV Años</option>
      <option value="Baby Shower">Baby Shower</option>
      <option value="Evento Corporativo">Evento Corporativo</option>
      <option value="Fiesta Infantil">Fiesta Infantil</option>
    </select>

    <label for="estadoEvento">Estado:</label>
    <select id="estadoEvento" [(ngModel)]="filtros.estadoEvento" (change)="aplicarFiltros()">
      <option value="">Todos</option>
      <option value="activo">Activo</option>
      <option value="pendiente">Pendiente</option>
      <option value="cancelado">Cancelado</option>
    </select>
  </div>

  <!-- Tabla -->
  <div class="table-responsive">
    <table class="table">
      <thead>
        <tr>
          <th style="width: 20%;">Nombre</th>
          <th style="width: 20%;">Contacto</th>
          <th style="width: 15%;">Fecha</th>
          <th style="width: 20%;">Tipo de Evento</th>
          <th style="width: 15%;">Estado</th>
          <th style="width: 10%;">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let reserva of reservasFiltradas">
          <td>{{ reserva.nombre_contacto }}</td>
          <td>{{ reserva.numero_telefono }}</td>
          <td>{{ reserva.fecha_evento | date: 'shortDate' }}</td>
          <td>{{ reserva.tipo_evento }}</td>
          <td>{{ reserva.estado_evento }}</td>
          <td>
            <button (click)="verDetalles(reserva)">Ver Detalles</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Modal de Detalles -->
  <div class="modal" *ngIf="reservaSeleccionada">
    <div class="modal-content">
      <h2>Detalles de la Reserva</h2>
      <form #editarForm="ngForm" (ngSubmit)="guardarCambios()">
        <p><strong>Nombre:</strong> {{ reservaSeleccionada.nombre_contacto }}</p>
        <p><strong>Contacto:</strong> {{ reservaSeleccionada.numero_telefono }}</p>

        <div *ngIf="!modoEdicion">
          <p><strong>Dirección:</strong> {{ reservaSeleccionada.direccion_local }}</p>
          <p><strong>Fecha:</strong> {{ reservaSeleccionada.fecha_evento | date: 'shortDate' }}</p>
          <p><strong>Hora:</strong> {{ reservaSeleccionada.hora }}</p>
          <p><strong>Tipo de Evento:</strong> {{ reservaSeleccionada.tipo_evento }}</p>
          <p><strong>Estado:</strong> {{ reservaSeleccionada.estado_evento }}</p>
          <p><strong>Descripción:</strong> {{ reservaSeleccionada.descripcion }}</p>
        </div>

        <div *ngIf="modoEdicion">
          <label for="direccion"><strong>Dirección:</strong></label>
          <input type="text" id="direccion" [(ngModel)]="reservaSeleccionada.direccion_local" name="direccion" required />

          <label for="fecha"><strong>Fecha:</strong></label>
          <input type="date" id="fecha" [(ngModel)]="reservaSeleccionada.fecha_evento" name="fecha" required />

          <label for="hora"><strong>Hora:</strong></label>
          <input type="time" id="hora" [(ngModel)]="reservaSeleccionada.hora" name="hora" required />

          <label for="tipoEvento"><strong>Tipo de Evento:</strong></label>
          <select id="tipoEvento" [(ngModel)]="reservaSeleccionada.tipo_evento" name="tipoEvento" required>
            <option value="Boda">Boda</option>
            <option value="XV Años">XV Años</option>
            <option value="Baby Shower">Baby Shower</option>
            <option value="Evento Corporativo">Evento Corporativo</option>
            <option value="Fiesta Infantil">Fiesta Infantil</option>
          </select>

          <label for="estado"><strong>Estado:</strong></label>
          <select id="estado" [(ngModel)]="reservaSeleccionada.estado_evento" name="estado" required>
            <option value="activo">Activo</option>
            <option value="pendiente">Pendiente</option>
            <option value="cancelado">Cancelado</option>
          </select>

          <label for="descripcion"><strong>Descripción:</strong></label>
          <textarea id="descripcion" [(ngModel)]="reservaSeleccionada.descripcion" name="descripcion" rows="3" required></textarea>
        </div>

        <!-- Botones -->
        <div class="modal-actions">
          <button *ngIf="!modoEdicion" type="button" (click)="activarEdicion()">Editar</button>
          <button *ngIf="modoEdicion" type="submit" [disabled]="!editarForm.valid">Guardar Cambios</button>
          <button type="button" (click)="cerrarModal()">Cancelar</button>
        </div>
      </form>
    </div>
  </div>
</div>
